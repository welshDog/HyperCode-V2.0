
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>HyperCode Knowledge Base</title>
                <script src="https://cdn.tailwindcss.com"></script>
                <style>
                    .loader {
                        border: 3px solid #f3f3f3;
                        border-top: 3px solid #3498db;
                        border-radius: 50%;
                        width: 20px;
                        height: 20px;
                        animation: spin 1s linear infinite;
                        display: inline-block;
                        margin-left: 10px;
                        vertical-align: middle;
                    }
                    @keyframes spin {
                        0% { transform: rotate(0deg); }
                        100% { transform: rotate(360deg); }
                    }
                </style>
            </head>
            <body class="bg-gray-100 min-h-screen">
                <div class="container mx-auto px-4 py-8">
                    <div class="max-w-4xl mx-auto">
                        <h1 class="text-3xl font-bold mb-2 text-blue-800">HyperCode Knowledge Base</h1>
                        <p class="text-gray-600 mb-6">Search through code, documentation, and research</p>
                        
                        <div class="mb-8 bg-white p-6 rounded-lg shadow-md">
                            <div class="relative">
                                <input 
                                    type="text" 
                                    id="searchInput" 
                                    placeholder="Search documents (min 2 characters)..." 
                                    class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                    autocomplete="off"
                                >
                                <div id="searchStatus" class="absolute right-3 top-3 hidden">
                                    <div class="loader"></div>
                                </div>
                            </div>
                            <div class="mt-2 text-sm text-gray-500">
                                <span id="resultCount">0</span> results found
                            </div>
                        </div>
                        
                        <div id="results" class="space-y-4">
                            <div class="text-center text-gray-500 py-10">
                                <p>Enter a search term to begin</p>
                            </div>
                        </div>
                        
                        <div id="noResults" class="hidden text-center py-10">
                            <p class="text-gray-500">No results found. Try different keywords.</p>
                        </div>
                    </div>
                </div>

                <script>
                    let searchTimeout;
                    const searchInput = document.getElementById('searchInput');
                    const resultsDiv = document.getElementById('results');
                    const resultCount = document.getElementById('resultCount');
                    const noResultsDiv = document.getElementById('noResults');
                    const searchStatus = document.getElementById('searchStatus');
                    
                    // Debounce search
                    searchInput.addEventListener('input', (e) => {
                        const query = e.target.value.trim();
                        
                        // Clear previous timeout
                        clearTimeout(searchTimeout);
                        
                        if (query.length < 2) {
                            resultsDiv.innerHTML = `
                                <div class="text-center text-gray-500 py-10">
                                    <p>Enter at least 2 characters to search</p>
                                </div>`;
                            noResultsDiv.classList.add('hidden');
                            resultCount.textContent = '0';
                            return;
                        }
                        
                        // Show loading indicator
                        searchStatus.classList.remove('hidden');
                        
                        // Set new timeout
                        searchTimeout = setTimeout(() => {
                            performSearch(query);
                        }, 300);
                    });
                    
                    async function performSearch(query) {
                        try {
                            const response = await fetch(`/api/search?q=${encodeURIComponent(query)}&limit=20`);
                            const results = await response.json();
                            
                            // Update result count
                            resultCount.textContent = results.length;
                            
                            if (results.length === 0) {
                                resultsDiv.classList.add('hidden');
                                noResultsDiv.classList.remove('hidden');
                            } else {
                                resultsDiv.classList.remove('hidden');
                                noResultsDiv.classList.add('hidden');
                                
                                // Display results
                                resultsDiv.innerHTML = results.map(result => `
                                    <div class="bg-white p-4 rounded-lg shadow hover:shadow-md transition-shadow">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <h2 class="text-xl font-semibold text-blue-700">${escapeHtml(result.file_name)}</h2>
                                                <p class="text-sm text-gray-500 mb-2">${escapeHtml(result.relative_path)}</p>
                                            </div>
                                            <span class="px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800">
                                                ${result.file_type.toUpperCase()}
                                            </span>
                                        </div>
                                        <p class="mt-2 text-gray-700 line-clamp-2">${escapeHtml(result.snippet)}</p>
                                        <div class="mt-3 text-right">
                                            <a href="/api/document/${result.id}" 
                                               class="text-blue-600 hover:underline text-sm"
                                               target="_blank">
                                                View Full Document
                                            </a>
                                        </div>
                                    </div>
                                `).join('');
                            }
                        } catch (error) {
                            console.error('Search error:', error);
                            resultsDiv.innerHTML = `
                                <div class="bg-red-50 border-l-4 border-red-500 p-4">
                                    <div class="flex">
                                        <div class="flex-shrink-0">
                                            <svg class="h-5 w-5 text-red-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.28 7.22a.75.75 0 00-1.06 1.06L8.94 10l-1.72 1.72a.75.75 0 101.06 1.06L10 11.06l1.72 1.72a.75.75 0 101.06-1.06L11.06 10l1.72-1.72a.75.75 0 00-1.06-1.06L10 8.94 8.28 7.22z" clip-rule="evenodd" />
                                            </svg>
                                        </div>
                                        <div class="ml-3">
                                            <p class="text-sm text-red-700">Error performing search. Please try again.</p>
                                        </div>
                                    </div>
                                </div>`;
                        } finally {
                            searchStatus.classList.add('hidden');
                        }
                    }
                    
                    // Helper function to escape HTML
                    function escapeHtml(unsafe) {
                        if (!unsafe) return '';
                        return unsafe
                            .toString()
                            .replace(/&/g, "&amp;")
                            .replace(/</g, "&lt;")
                            .replace(/>/g, "&gt;")
                            .replace(/"/g, "&quot;")
                            .replace(/'/g, "&#039;");
                    }
                    
                    // Focus search input on page load
                    window.addEventListener('load', () => {
                        searchInput.focus();
                    });
                </script>
            </body>
            </html>
            