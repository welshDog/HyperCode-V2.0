# API Reference

This document outlines the API endpoints expected by the HyperFlow Editor frontend. The backend (`hypercode-core`) should implement these endpoints to ensure full functionality.

## Base URL
All requests are relative to the configured `VITE_HYPERCODE_CORE_URL` (default: `http://localhost:8000`).

## Authentication
All API requests must include the `Authorization` header with a valid Bearer token:
```http
Authorization: Bearer <your-api-key>
```

## Endpoints

### Agents

#### `GET /api/v1/agents`
Retrieves a list of all active agents.

**Response:**
```json
[
  {
    "id": "string",
    "name": "string",
    "role": "string",
    "status": "idle" | "working" | "completed" | "failed",
    "logs": ["string"]
  }
]
```

#### `POST /api/v1/ai/generate`
Creates a new AI agent task based on a prompt.

**Request Body:**
```json
{
  "task_description": "string"
}
```

**Response:**
```json
{
  "id": "string",
  "name": "string",
  "role": "string",
  "status": "pending"
}
```

#### `GET /api/v1/agents/{id}/artifact`
Downloads the artifact generated by a completed agent task.

**Response:**
-   **Content-Type**: `application/zip` (or other file type)
-   **Content-Disposition**: `attachment; filename="artifact.zip"`

### Budget

#### `GET /api/v1/ai/budget/status`
Retrieves the current budget utilization.

**Response:**
```json
{
  "total": number,
  "spent": number
}
```

## WebSocket

### Connection
**URL**: `/ws/visual-cortex`
**Query Parameters**: `token=<your-api-key>`

### Events

#### `agent:update`
Sent when an agent's status changes.

**Payload:**
```json
{
  "type": "agent:update",
  "payload": {
    "id": "string",
    "status": "working" | "completed" | "failed"
  }
}
```

#### `agent:complete`
Sent when an agent completes a task.

**Payload:**
```json
{
  "type": "agent:complete",
  "payload": {
    "id": "string",
    "status": "completed",
    "artifactUrl": "string"
  }
}
```

#### `agent:error`
Sent when an agent encounters an error.

**Payload:**
```json
{
  "type": "agent:error",
  "payload": {
    "id": "string",
    "status": "failed",
    "error": "string"
  }
}
```
